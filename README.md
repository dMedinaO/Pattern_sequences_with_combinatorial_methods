# Combinatorial strategies for pattern recognition on protein primary sequence

## Input data

Sequences in fasta format

## Output data

Sequences classified into proposed categories

## Summary Process

### 1. Preparing sequences

```shell script
python3 process_input_file.py input_sequences path_ouput
```
It will be generated two csv files

* ignored_sequences.csv
* input_sequences_to_process.csv

And a JSON summary with element of process

* summary_preprocess.json

### 2. Encoding process

The encoding process transform categorical datasets (the sequences) into numerical vectors, there are different strategies to encoding sequences. The most knowledged are:

* One Hot encoding
* Ordinal Encoding
* Frequency of residues
* Physicochemical properties

One Hot, Ordinal and Frequency strategies will not be used in this project because these representations are not informative concerning different properties of the sequences.

In this project, We will be used Physicochemical properties. Besides, We will apply digital signal processing over sequences encoding based on physicochemical properties. Also, We will use embedding encodings employing TAPE library. 

On this form, there are three encodings strategies to use:

* Physicochemical properties (extracted from AAIndex database and preprocessed by previous reports)
* Digital signal processing over physicochemical properties
* Embedding representations

For encoding using TAPE, you should apply the script: 

```shell script
python3 encoding_using_TAPE.py input_sequences path_ouput
```

* Input_sequences is the csv file generated by process_input_file.py script and the path_output represents the path to save the results.

* This script will create a directory to save the encoding dataset 

NOTE: You must have installed and prepared [TAPE](https://github.com/songlab-cal/tape)

For encoding using Physicochemical properties you should apply the script:

```shell script
python3 encoding_using_physicochemical_properties.py input_sequences path_encoding_AA_index path_output
```

* Input_sequences is the csv file generated by process_input_file.py script.
* path_encoding_AA_index is the path to physicochemical properties generated by PCA-exploration and semantinc clustering of properties collected from AAIndex 

NOTE: For more information about this process, please see our previous work [FFT-based methodology for protein rational design](https://www.researchgate.net/publication/344530124_Combination_of_digital_signal_processing_and_assembled_predictive_models_facilitates_the_rational_design_of_proteins)

* path_output represent the path to save all encodings data. This script create a directory in path_output to save the information 

For encoding using digital signal processing, you should exec the script:

```shell script
python3 encoding_using_Fourier_Transform.py path_sequences_encoding_by_physicochemical_properties path_output_data
```

This script apply Fast Fourier Transformation over sequences encoding based on physicochemical properties.

### 3. To Apply clustering based on alignment sequences

Taking all sequences in dataset preprocessed in stage 1. You can apply and community search strategy to identify groups, based on graph structure representations of the sequences and alignment process. First, it is necessary apply alignment over all combinations of the sequences employing [BioPython Libraries](https://biopython.org/). Next, you should generate an Adjacency matrix with sequences and its alignment score. Finally, you can apply community search algorithms based on Python Libraries and you will be able to recognize groups into graph structure.

For reply the process previously described, you should execute the next scripts:

```shell script
python3 make_alignment_sequences.py  input_sequences path_output
```

This script creates an Adjacency Matrix and a HeatMap with scoring matrix.

For community search, you can apply the script:

```shell script
python3 community_search.py  input_data path_output
```

Where input data concerning to adjacency matrix previously created and path output is used to save the output files (dataset with ID-sequences and clustering ID), generated graph visualization splitter into community detected, and summary graph with statistical process and data information of the results in JSON format. 

* NOTE: This scripts are in the directory graph_based_alignment.

* NOTE: Se necesita afinar detalles en el algoritmo y la identificación de los cluster, existen distintas formas de obtener grupos en base a grafos y diferentes estrategias para armar la estructura. De momento, en base a ensayos, lo mejor es mantener la resolución al 1.0 y trabajar en la generación de aristas en base a cuartiles. Por lo tanto, requiere un mayor análisis en cuanto a los temas de desarrollo de clustering en base a grafos contemplando los score del alineamiento como base. Otro punto de interés, es posible que la métrica de score, no sea una representación estandarizada del proceso, por lo cual las comunidades no quedan bien definidas. 

Otro punto importante consiste en la elaboración de diferentes conjuntos de datos, ya que con el análsis del conjunto de datos de DBP... es bastante complejo el proceso en si.


### 4. To Apply clustering based on unsupervised learning algorithms

Embedding representations and Physicochemical properties, can be used as input for unsupervised learning algorithms and pattern recognition based on the application of these strategies.

First, you should standardize the dataset, next you can apply an exploration stage of different unsupervised learning methods and hyperparameters configuration.

To make this exploration, you can exec the script:

```shell script
python3 exploring_supervised_learning_methods.py  input_data path_output
```

Input data represents the encoding sequences and path output is concerning to save results

For the case of physicochemical properties, the script launch_clustering_for_properties.py can be applied to make the exploring over the different physicochemical properties.

```shell script
python3 launch_clustering_for_properties.py  input_data path_output
```

On input data represent the path of encoding sequences and path output represents the path to save results of process.

### 5. To Apply clustering based on time series clustering

Clustering based on time series can be applied to digital signal processing due to the characteristic of the data. Using clasical unsupervised learning over this type of dataset have not sense, because employing different type of distance to evaluate relations between examples. However, these distances not consider the shape of the curve.

Based on previously exposed, We decided apply time series clustering algorithms. Similar to unsupervised learning learning. We have developed an exploration strategie based on different algorithms and hiperparameters to evaluate pattern recognition.

For apply time series clustering, you can exec the next script:

```shell script
python3 time_series_clustering.py  input_data path_output
```

Input data represent the dataset encoding using digital signal processing based on Fast Fourier Transformation and the path output is related to directory to save the results.

For automatize the process, you can use the script launcher_ts_clustering.py and apply clustering time series for each physicochemical property previously digital signal processing developed.

```shell script
python3 launcher_ts_clustering.py path_input path_output
```

Path input represents the directory with digital signal processing developing and Path output is related with directory to save all results of process.

### 6. To Apply clustering based on community search

Community search is another strategy to identify groups or patterns in a dataset based on the use of graph structures.

To build the graph structures, you can apply the scripts make_distance_matrix_using_datasets.py or make_distance_matrix_using_FFT.py, depends of type of data to process (normal datasets or time series datasets)

Two step are necessary for generating community: make distance matrix and apply community search.

The scripts to generate the distance matrix are executed by the next command line:

```shell script
python3 make_distance_matrix_using_datasets.py dataset path_output
```

```shell script
python3 make_distance_matrix_using_FFT.py dataset path_output
```

To make an automatization of the process you can exec the scripts launchers_distance_XXX, to exec the scripts you can apply a command line as:

```shell script
python3 launcher_distance_properties.py dataset path_output
```

This can be used for FFT data and physicochemical properties, obviously using the corresponding python script.

Finally, you can apply the scripts to community search based on matrix distances previously got. For exec this script you can apply the next command line:

```shell script
python3 community_search.py dataset path_output
```

```shell script
python3 community_search_FFT.py dataset path_output
```

There are variations when you use a tipical data or dataset based on time series.

Similar to automatization for making matrix distance, you can apply the scripts launcher_community_XXX to get all community based on graph structure.

### 7. Creating the probability matrix relation

Employing all results of different encoding strategies and pattern recognition algorithms, 